function [ xdot ] = CSTR( x, u )

    import casadi.*;

    c_AO = 5.1;
    v_0 = 104.9;
    k_w = 4032.0;
    A_R = 0.215;
    rho = 0.9342;
    C_P = 3.01;
    V_R = 10.0;
    H_1 = 4.2;
    H_2 = -11.0;
    H_3 = -41.85;
    m_K = 5.0;
    C_PK = 2.0;
    k10 = 1.287e12;
    k20 = 1.287e12;
    k30 = 9.043e09;
    E1  = -9758.3;
    E2  = -9758.3;
    E3  = -8560.0;
    k_1 = k10*exp(E1/(273.15 +x(3)));
    k_2 = k20*exp(E2/(273.15 +x(3)));
    k_3 = k30*exp(E3/(273.15 +x(3)));
    secsPerHr = 3600;

    xdot = [(u(1)*(c_AO - x(1))-k_1*x(1)-k_3*x(1)*x(1));...
        (-u(1)*x(2)+k_1*x(1)-k_2*x(2));...
        (u(1)*(v_0-x(3))+(k_w*A_R/(rho*C_P*V_R))*(x(4)-x(3))-(1/(rho*C_P))*(k_1*x(1)*H_1+k_2*x(2)*H_2+k_3*x(1)*x(1)*H_3));...
        (1/(m_K*C_PK))*(u(2)+k_w*A_R*(x(3)-x(4)))]...
        /secsPerHr;

end
